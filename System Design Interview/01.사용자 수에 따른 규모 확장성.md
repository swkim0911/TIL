# 단일 서버
모든 컴포넌트(웹 앱, DB, 캐시 등)가 한 대의 서버에서 실행되는 간단한 시스템.

그림 1-2

1. 사용자는 도메인 이름(api.mysite.com)을 이용하여 웹사이트에 접속한다. 이 접속을 위해서 도메인 이름을 DMS에 질의하여 IP 주소로 변환하는 과정이 필요하다.
2. DNS 조회 결과로 IP 주소가 반환된다.
3. 해당 IP 주소로 HTTP 요청이 전돨된다.
4. 요청을 받은 웹 서버는 HTML 페이지나 JSON 형태의 응답을 반환한다.

실제 요청은 다음 두 가지 종류의 단말로부터 온다.
- 웹 애플리케이션
- 모바일 앱

# 데이터 베이스
사용자가 늘면 서버 하나로 충분하지 않아 여러 서버를 두어야 한다. 하나는 웹/모바일 트래픽 처리 용도고, 다른 하나는 DB용이다. 웹/모바일 트래픽 처리 서버(웹 계층)와 DB 서버(데이터 계층)를 분리하면 각각 독립적으로 확장할 수 있다.

그림 1-3 draw.io

## 어떤 데이터베이스를 사용할 것인가?

### 관계형 데이터베이스
- 자료를 테이블과 열, 컬럼으로 표현한다.
- SQL을 사용하면 여러 테이블에 있는 데이터를 그 관계에 따라 조인(join)하여 합칠 수 있다.

### 비 관계형 데이터베이스
- 일반적으로 조인 연산을 지원하지 않는다.

### 비 관계형 데이터베이스를 선택하는 경우
-  아주 낮은 응답 지연시간(latency)을 요구하는 경우
    - 응답 지연시간: 시스템에서 요청을 보낸 시점부터 그에 대한 응답이 도착하는 시점까지 걸리는 시간

-  다루는 데이터가 비정형이라(unstructured) 관계형 데이터가 아닌 경우
   -  비정형 데이터: 고정된 구조나 스키마가 없는 데이터. 텍스트 문서, 미디어 파일, 로그 파일 등이 있다.

-  데이터(JSON, YAML, XML 등)를 직렬화하거나 역직렬화할 수 있기만 하면 되는 경우
   - 데이터 간에 (복잡한) 관계, 트랜잭션 관리가 필요한 경우 관계형 데이터베이스 사용을 고려한다. 
-  아주 많은 양의 데이터를 저장할 필요가 있는 경우

# 수직적 규모 확장 vs 수평적 규모 확장
- 수직적 규모 확장(scale up): 서버에 고사양 자원(더 좋은 CPU, RAM)을 추가하는 행위
- 수평적 규모 확장(scale out): 더 많은 서버를 추가하여 성능을 개선하는 행위

## 수직적 규모 확장의 장·단점
- 서버로 유입되는 트래픽의 양이 적을 때 좋은 선택이며 이 방법의 장점은 단순함이다.
- 하지만, 한계가 있다. 한 대의 서버에 CPU나 메모리를 무한대로 증설할 방법은 없다.
- 장애에 대한 자동복구(failover) 방안이나 다중화(redundancy) 방안을 제시하지 않는다.
  - failover: 시스템 장애가 발생했을 때, 장애가 발생한 시스템의 기능을 자동으로 대체 시스템으로 전환하여 서비스의 연속성을 유지하는 과정
  - redundancy: 시스템의 신뢰성과 가용성을 높이기 위해 동일한 기능을 수행하는 여러 개의 구성 요소를 중복 배치하는 전략

이런 단점 때문에 대규모 애플리케이션을 지원하는 데는 수평적 규모 확장이 적절하다.


## 로드밸런서
앞서 본 설계에서 사용자는 웹 서버에 바로 연결된다. 웹 서버가 다운되면 사용자는 웹 사이트에 접속할 수 없다. 또한, 너무 많은 사용자가 접속하여 웹 서버가 한계 상황에 도달하게 되면 응답 속도가 느려지거나 서버 접속이 불가능해질 수도 있다. 이런 문제를 해결하는 데에 로드밸런서를 도입하는 것이 최선이다.

로드밸런서는 부하 분산 집합(load balancing set)에 속한 웹 서버들에게 트래픽 부하를 고르게 분산하는 역할을 한다.

그림 1-4

## 데이터베이스 다중화

# 캐시

## 캐시 계층


