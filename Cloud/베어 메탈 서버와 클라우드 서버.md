# 베어 메탈 서버와 클라우드 서버
## 개요
GeekNews를 보다가 ["AWS에서 베어-메탈로 이전하여 연간 23만 달러 절약"](https://news.hada.io/topic?id=11954)이라는 글을 보았다. 제목이 흥미로우면서도 '베어 메탈이 무엇인지', '클라우드 서버가 정확히 어떤 환경이길래 이전 후 비용을 절약할 수 있었는지'등 익숙하게 사용해온 클라우드 서버에 대해 근본적인 의문점이 생겨서 글을 정리한다.

## 호스팅(hosting)의 역사
베어 메탈 서버와 클라우드 서버에 대해 이해하기 위해서 호스티의 탄생에 대해 돌아봐야 한다.

> 호스팅(hosting): 서버나 시스템 자원을 빌려주는 서비스

World Wide Web(WWW)의 등장으로 닷컴 붐이 일어나고, 웹사이트가 급격히 늘어났다. 이에 서버를 안정적으로 운영하기 위한 물리적 인프라(전력, 냉방, 인터넷 연결등) 수요가 커졌지만, 모든 개인이나 기업이 이를 자체적으로 구축할 수는 없었다. 그래서 일부 사업자들이 완비된 환경을 갖춘 공간을 임대하기 시작했고, 이것을 **코로케이션(colocation)**이라고 한다.

> 코로케이션(colocation): 기업이 자체 서버와 같은 IT 장비를 전문 데이터 센터(IDC)에 입주시켜 보관하고 관리하는 서비스

코로케이션이 생성된 이후에는 전체 서버의 일부 리소스를 임대하는 공유 호스팅(shared hosting)이 나타났다. 하지만 점점 애플리케이션이 복잡해지고 리소스를 많이 쓰게 되면서 공유 호스팅으로 감당하기 어려워졌다. 그래서 기업들은 서버 한 대 전체가 필요했지만, 직접 하드웨어를 구매하거나 코로케이션 공간에 설치할 자본이 항상 있는 건 아니었다. 이런 배경에서 등장하는 것이 전용 호스팅(dedicated hosting), 즉 **베어 메탈 호스팅(bare metal hosting)**이다.

하지만 베어 메탈 호스팅은 프로비저닝(provisioning) 속도가 너무 느렸다. 이제는 비즈니스 속도가 너무 빨라지면서 기업은 몇 분 안에 새로운 서버를 구축하는게 필요했고, 그래서 **가상화(virtualization)**가 탄생했다.

> 프로비저닝(provisioning): 사용자가 IT 자원을 사용할 수 있도록 준비하고 공급하는 일련의 과정

## 베어 메탈 서버 (bare metal server)
베어 메탈 서버는 가상화되지 않은 물리 서버(하드웨어)를 단독으로 임대하여 사용하는 서비스이다. 베어 메탈 서버는 사용자가 독점적으로 사용하는 서버이기 때문에, 고객은 높은 수준의 보안, 제어권, 그리고 뛰어난 성능의 이점을 누릴 수 있다.

## 클라우드 서버 (cloud server)
클라우드 서버는 다른 사람의 물리 서버를 가상화한 것이다. 운영체제가 물리 서버 위에 직접 설치되는 베어 메탈 서버와 달리, '하이퍼바이저(hypervisor)'가 존재하며, 이 하이퍼바이저가 하나의 서버 위에 여러 개의 가상 머신을 만든다. 하이퍼바이저는 서버의 자원(CPU, RAM, 저장공간, 네트워크)을 여러 가상 머신들 사이에 분할하고, 각각의 가상 머신 위에 독립적인 운영체제를 설치하고, 그 위에 애플리케이션이 올라간다.

### 하이바이저의 가상 네트워크
물리적 서버에 NIC(Network Interface Card)가 하나라면 각각의 가상 머신 위의 운영체제는 어떻게 네트워크 통신을 할까? 방법은 하이퍼바이저가 가상 NIC(vNIC)와 가상 스위치(vSwitch)를 만든다.

TCP/IP 4계층으로 생각해보면 하이퍼바이저는 내부적으로 네트워크 액세스 계층에서 NIC를 가상화해서 OS에게 네트워크 기능을 제공하는 것이다. 결과적으로 NIC는 하나뿐이어도, 하이퍼바이저가 그 위에 여러 논리적 NIC + 스위치를 만들어서 여러 VM이 동시에 네트워크를 쓸 수 있게 한다.

```
┌──────────────────────────┐
│          하이퍼바이저         │
│ ┌──────────────────────┐ │
│ │  vSwitch (가상 스위치)   │ │ ← 소프트웨어로 만든 내부 스위치
│ │   ├── vNIC1 (VM1용)   │ │
│ │   ├── vNIC2 (VM2용)   │ │
│ │   └── vNIC3 (VM3용)   │ │
│ └──────────────────────┘ │
│         ↓ (Bridge)         │
│   Physical NIC (eth0)       │
└──────────┬──────────────┘
           │
        외부 네트워크
```

## 베어 메탈 서버와 클라우드 서버의 비교
| 항목            | **베어 메탈 서버**                        | **클라우드 서버**             |
| --------------- | ---------------------------------------- | ----------------------------- |
| **설정 속도**   | 느림            | 매우 빠름        |
| **확장성**      | 제한적                                   | 즉시 확장 가능                |
| **성능 일관성** | 매우 높음 (자원 독점)                    | 변동 있음 (공유 자원)         |
| **비용 구조**   | 장기적으로 저렴                          | 사용량에 따라 급증 가능       |
| **적합한 경우** | 예측 가능한 부하, 고성능 필요            | 변동성 큰 부하, 초기 스타트업 |





### 참고
- https://www.servers.com/news/blog/bare-metal-vs-cloud-servers-what-s-the-difference

- ChatGPT